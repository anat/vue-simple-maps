[dev]
  command = "yarn workspace frontend start"
  targetPort = 8080
  framework = "#custom"

[build]
  # Directory (relative to root of your repo) that contains the deploy-ready
  # HTML files and assets generated by the build. If a base directory has
  # been specified, include it in the publish directory path.

  # Default build command.
  command = "yarn workspace frontend generate"

  publish = "frontend/dist"

  ignore = "git diff --quiet HEAD^ HEAD frontend/"

  functions = "frontend/functions/bin"

[build.environment]
  NODE_ENV = "production"
  BUILD_ENV = "production"

[context.staging.environment]
  STRAPI_URL = "https://api-teageorgia-staging.herokuapp.com"
  BUILD_ENV = "staging"
  SNIPCART_API_KEY = "MjZhODc0MzktOGY4Ny00YWFjLTk3NDYtMDIwYTk4ODc3OTIzNjM3MTgwNTk1ODQ2NzIwNDkw"
  SNIPCART_PAYMENT_API_KEY = "NGQwMWNkMjEtOWRkMy00MTZlLTgyMDYtNjUxMjU2MDJhNWRkNjM3MjE0MTk5ODAyMjY2MTk3"

[context.deploy-preview]
  BUILD_ENV = "deploy-preview"

[context.branch-deploy]
  BUILD_ENV = "branch-deploy"

[[redirects]]
  from = "/*/index.html"
  to = "/:splat:"
  status = 200
  force = false

[[redirects]]
  from = "/auth"
  to = "/auth/login"
  status = 301
  force = true

[[redirects]]
  from = "/en/auth"
  to = "/en/auth/login"
  status = 301
  force = true

[[redirects]]
  from = "/ru/auth"
  to = "/ru/auth/login"
  status = 301
  force = true

[[redirects]]
  from = "https://teageorgia.netlify.com"
  to = "https://teageorgia.com"
  status = 301
  force = true

[[redirects]]
    from = "https://teageorgia.netlify.com/*"
    to = "https://www.teageorgia.com/:splat"
    status = 301
    force = true

# [[redirects]]
#   from = "/*"
#   to = "/en/:splat"
#   status = 302
#   force = false
#   conditions = {Language = ["en"]}

# [[redirects]]
#   from = "/*/"
#   to = "/ru/:splat"
#   status = 302
#   force = false
#   conditions = {Language = ["ru"]}
